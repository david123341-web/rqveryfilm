
<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>RQå¨›æ¨‚å½±åƒå·¥ä½œå®¤ï½œä½œå“é›†</title>
<meta name="description" content="RQå¨›æ¨‚å½±åƒå·¥ä½œå®¤ï½œæ—¥ç³»æ¸…çˆ½çš„å½±åƒæ•˜äº‹ï¼šPodcastã€çŸ­å½±ç‰‡å»£å‘Šã€å½¢è±¡å½±ç‰‡ã€è­‰è¨€å»£å‘Šã€ç¯€ç›®è£½ä½œã€‚">
<meta name="theme-color" content="#FF8A00">

<!-- ğŸ”¥ Anti-cacheï¼šè®“æ‰‹æ©Ÿ/æ¡Œæ©Ÿæ°¸é æŠ“æœ€æ–°ç‰ˆ -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<script>
  // æ¯æ¬¡è¼‰å…¥éƒ½åœ¨ç¶²å€å¾ŒåŠ ä¸Šæ™‚é–“æˆ³ï¼Œä¿è­‰æŠ“åˆ°æœ€æ–°ç‰ˆæœ¬
  (function() {
    const url = new URL(window.location.href);
    const cacheBuster = 'v=' + new Date().getTime();
    if (!url.search.includes('v=')) {
      url.search += (url.search ? '&' : '?') + cacheBuster;
      window.location.replace(url.toString());
    }
  })();
</script>
<!-- ğŸ”¥ End Anti-cache -->

<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600&family=Noto+Serif+TC:wght@500;700&display=swap" rel="stylesheet">
<style>
:root{--orange:#FF8A00;--ink:#363636;--powder:#FFF2DF;--ink-60:rgba(54,54,54,.6);--ink-30:rgba(54,54,54,.3);--radius:14px;--shadow:0 10px 25px rgba(0,0,0,.08);--maxw:1120px;}
*{box-sizing:border-box} html,body{margin:0;background:var(--powder);color:var(--ink);-webkit-font-smoothing:antialiased}
body{font-family:"Noto Sans TC","Microsoft JhengHei",sans-serif;line-height:1.6}
h1,h2,h3{font-family:"Noto Serif TC",serif;margin:0 0 .4em}
a{color:var(--ink);text-decoration:none} a:hover{color:var(--orange)}
.wrap{max-width:var(--maxw);margin:0 auto;padding:24px;position:relative}

/* header */
header{position:sticky;top:0;z-index:10;background:rgba(255,242,223,.75);backdrop-filter:saturate(180%) blur(16px);border-bottom:1px dashed var(--ink-30)}
.nav{display:flex;align-items:center;gap:16px;justify-content:space-between}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:36px;height:36px;border-radius:9px;background:var(--orange);display:flex;align-items:center;justify-content:center;font-family:"Noto Serif TC",serif;font-weight:700;font-size:20px;color:#fff;box-shadow:inset 0 0 0 2px rgba(255,255,255,.55);cursor:pointer;}
.brand h1{font-size:18px;letter-spacing:.5px}
.menu{display:flex;gap:14px;font-size:14px}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;border:1px solid var(--ink-30);background:#fff;box-shadow:0 2px 0 rgba(0,0,0,.04);cursor:pointer;user-select:none}
.btn.primary{border-color:transparent;background:var(--orange);color:#fff}
.btn.small{padding:8px 12px;font-size:13px}

/* hero */
.hero{display:grid;grid-template-columns:1.1fr .9fr;gap:28px;align-items:center;padding:36px 0}
.lead{color:var(--ink-60)}
.cta{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}

/* sections / bars */
section{margin:20px 0 36px}
.sec-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.sec-title{display:flex;align-items:center;gap:10px}
.sec-title .dot{width:10px;height:10px;border-radius:50%;background:var(--orange)}
.bar{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin:10px 0 18px}
.search{flex:1;min-width:220px;display:flex;align-items:center;gap:10px;background:#fff;border:1px solid var(--ink-30);border-radius:999px;padding:8px 12px}
.search input{flex:1;border:none;outline:none;background:transparent;font-size:14px}
.bar .right-actions{display:flex;gap:8px;align-items:center}

/* cards */
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
@media (max-width:980px){.hero{grid-template-columns:1fr}.grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:560px){.grid{grid-template-columns:1fr}}
.card{background:#fff;border:1px solid var(--ink-30);border-radius:var(--radius);padding:16px;display:flex;flex-direction:column;gap:10px;box-shadow:var(--shadow);position:relative}
.card .title{font-weight:600}
.card .meta{font-size:12px;color:var(--ink-60)}
.card .actions{display:flex;gap:8px;margin-top:auto;flex-wrap:wrap;justify-content:flex-end}
.open{margin-left:auto}

/* ç®¡ç†æŒ‰éˆ•ï¼ˆä¸Š/ä¸‹ç§»æ”¹ç‚ºæ‹–æ›³ï¼‰ */
.card .x,.card .edit{display:none;position:absolute;top:8px;background:#000;color:#fff;border:none;border-radius:999px;width:26px;height:26px;cursor:pointer;align-items:center;justify-content:center;line-height:1}
.card .x{right:8px}.card .edit{right:40px}
.editing .card .x,.editing .card .edit{display:flex}

/* æ‹–æ›³æç¤º */
.drag-hint{display:none;position:absolute;left:10px;top:10px;width:22px;height:22px;border-radius:999px;background:#f2f2f2;border:1px solid #ddd;align-items:center;justify-content:center;font-size:14px;line-height:1;cursor:grab}
.editing .drag-hint{display:flex}
.card[draggable="true"]{cursor:grab}
.card.dragging{opacity:.7}
.card.drop-target{outline:2px dashed var(--orange);outline-offset:2px}

/* embeds */
.embeds{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width:980px){.embeds{grid-template-columns:1fr}}
.embed-card{background:#fff;border:1px solid var(--ink-30);border-radius:var(--radius);padding:12px;box-shadow:var(--shadow)}
.embed-head{display:flex;align-items:center;justify-content:space-between;margin:0 0 8px}
.embed-title{font-size:16px;font-weight:600}
.embed-btn{font-size:12px;border:1px solid var(--ink-30);border-radius:999px;background:#fff;padding:6px 10px;cursor:pointer}
.embed{position:relative;width:100%;aspect-ratio:16/9;border-radius:10px;overflow:hidden;background:#000}
.embed iframe{position:absolute;inset:0;width:100%;height:100%;border:0}

/* contact */
.contact-cards{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
@media (max-width:560px){.contact-cards{grid-template-columns:1fr}}
.contact-card{background:#fff;border:1px dashed var(--ink-30);border-radius:var(--radius);padding:16px}
footer{padding:20px 0;color:var(--ink-60);font-size:12px}

/* adminï¼ˆé è¨­éš±è—ï¼›æé«˜å±¤ç´šé¿å…è¢«æ“‹ï¼‰ */
.admin-fab{position:fixed;right:18px;bottom:18px;z-index:9999;display:none}
.fab{border-radius:999px;border:1px solid var(--ink-30);background:#fff;padding:12px 14px;box-shadow:var(--shadow);cursor:pointer}
.panel{position:fixed;right:18px;bottom:74px;background:#fff;border:1px solid var(--ink-30);border-radius:12px;box-shadow:var(--shadow);padding:12px;display:none;flex-direction:column;gap:8px;min-width:290px;z-index:10000}
.panel.show{display:flex}
.admin-tip{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:#000;color:#fff;font-size:12px;padding:8px 10px;border-radius:8px;opacity:.85;display:none}

/* accordion categories */
.cat{border:1px solid var(--ink-30);border-radius:14px;background:#fff;box-shadow:var(--shadow);overflow:hidden;margin-bottom:14px}
.cat-head{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;padding:12px 14px}
.cat-title{display:flex;align-items:center;gap:10px;font-weight:700}
.cat-count{font-size:12px;color:var(--ink-60)}
.cat-actions{display:flex;gap:8px}
.cat-body{display:none;padding:12px;border-top:1px dashed var(--ink-30)}
.cat.open .cat-body{display:block}

/* covers */
.cover{grid-column:1/-1;background:#FFF7EB;border:1px dashed var(--ink-30);border-radius:12px;padding:0;overflow:hidden}
.cover-inner{display:grid;grid-template-columns:1fr 1.3fr;align-items:center}
.cover-info{padding:16px}
.cover-info h3{margin:0 0 4px;font-size:20px}
.cover-info p{margin:0;color:var(--ink-60);font-size:13px}
.cover-illu{position:relative;aspect-ratio:16/9;background:linear-gradient(135deg,#FFE5C2,#FFF7EB)}
.cover-illu svg{position:absolute;inset:0;width:100%;height:100%}
.cover:hover{box-shadow:0 12px 28px rgba(0,0,0,.08)}

/* login */
.login-mask{position:fixed;inset:0;background:rgba(0,0,0,.35);backdrop-filter:blur(6px);display:none;align-items:center;justify-content:center;z-index:11000}
.login-card{width:min(420px,92vw);background:#fff;border:1px solid var(--ink-30);border-radius:16px;box-shadow:var(--shadow);padding:18px}
.login-card h3{margin:0 0 6px;font-size:18px}
.field{display:flex;flex-direction:column;gap:6px;margin:8px 0}
.field label{font-size:12px;color:var(--ink-60)}
.field input{border:1px solid var(--ink-30);border-radius:10px;padding:10px 12px;font-size:14px}
.row{display:flex;gap:8px;align-items:center;justify-content:flex-end;margin-top:12px;flex-wrap:wrap}
</style>
</head>
<body>
<header>
  <div class="wrap nav">
    <div class="brand">
      <div class="logo" aria-label="RQ Logo">Q</div>
      <h1 id="siteTitle" data-editable>RQå¨›æ¨‚å½±åƒå·¥ä½œå®¤</h1>
    </div>
    <nav class="menu">
      <a href="#works" class="btn small">ä½œå“</a>
      <a href="#contact" class="btn small">è¯çµ¡</a>
      <a href="#about" class="btn small">é—œæ–¼</a>
    </nav>
  </div>
</header>

<main class="wrap">
  <section class="hero" id="about">
    <div>
      <h2 id="heroTitle" data-editable>æŠŠç”Ÿæ´»æ‹æˆæ•…äº‹ï¼ŒæŠŠå“ç‰Œæ‹æˆè¨˜æ†¶ã€‚</h2>
      <p class="lead" id="heroLead" data-editable>æˆ‘å€‘å°ˆæ³¨æ–¼ <strong>Podcast ç¯€ç›®è£½ä½œã€çŸ­å½±ç‰‡å»£å‘Šã€å½¢è±¡å½±ç‰‡ã€è­‰è¨€å»£å‘Šã€ç¯€ç›®ä¼åŠƒèˆ‡åŸ·è¡Œ</strong>ã€‚æ¥µç°¡ç•«é¢è£¡ï¼Œç•™ä¸‹æœ€å‰›å¥½çš„æƒ…ç·’èˆ‡å…‰ã€‚</p>
      <div class="cta">
        <a id="ctaIG" class="btn primary" href="https://www.instagram.com/rqverycute" target="_blank" rel="noopener">IG ç§è¨Š</a>
        <a id="ctaFB" class="btn" href="#" target="_blank" rel="noopener">Facebook ç²‰å°ˆ</a>
      </div>
    </div>
    <div>
      <div class="contact-cards">
        <div class="contact-card"><div class="sec-title" style="margin-bottom:6px"><span class="dot"></span><h3 style="font-size:16px">æœå‹™é …ç›®</h3></div>
          <div class="pill">çŸ­å½±ç‰‡å»£å‘Š</div><div class="pill">å½¢è±¡å½±ç‰‡</div><div class="pill">è­‰è¨€å»£å‘Š</div><div class="pill">ç¯€ç›®è£½ä½œ</div><div class="pill">Podcast</div>
        </div>
        <div class="contact-card"><div class="sec-title" style="margin-bottom:6px"><span class="dot"></span><h3 style="font-size:16px">å¿«é€Ÿè³‡è¨Š</h3></div>
          <div class="meta"><strong>é›»æ´½ / åˆä½œ</strong><br><span id="quickNote" data-editable>ç§è¨Š IG æˆ– FBï¼Œæä¾›å¤§ç¶±ï¼é ç®—ï¼æ™‚ç¨‹ï¼Œæˆ‘å€‘ 24 å°æ™‚å…§å›è¦†ã€‚</span></div>
        </div>
      </div>
    </div>
  </section>

  <section id="featured">
    <div class="sec-head"><div class="sec-title"><span class="dot"></span><h2 style="font-size:22px">ç«‹å³æ”¶è½ / è§€çœ‹</h2></div></div>
    <div class="embeds">
      <div class="embed-card">
        <div class="embed-head"><div class="embed-title">Podcastã€Šç™½ç›®æƒ…ä¾¶é€±è¨˜ã€‹</div><button class="embed-btn" id="btnEditPlaylist" style="display:none">æ›´æ›æ¸…å–®</button></div>
        <div class="embed"><iframe id="podcastEmbed" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe></div>
        <div class="meta" style="margin-top:6px">â€» ä¾†æºï¼šYouTube æ’­æ”¾æ¸…å–®</div>
      </div>
      <div class="embed-card">
        <div class="embed-head"><div class="embed-title">ç²¾é¸å½±ç‰‡</div><button class="embed-btn" id="btnEditVideo" style="display:none">æ›´æ›å½±ç‰‡</button></div>
        <div class="embed"><iframe id="videoEmbed" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe></div>
        <div class="meta" style="margin-top:6px">â€» å¯æ›´æ›ç‚ºä»»ä¸€ YouTube å½±ç‰‡</div>
      </div>
    </div>
  </section>

  <section id="works">
    <div class="sec-head"><div class="sec-title"><span class="dot"></span><h2 style="font-size:22px">ä½œå“é›†</h2></div></div>
    <div class="bar">
      <div class="search">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.2-4.2M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z" stroke="#999" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="search" type="search" placeholder="æœå°‹æ¨™é¡Œæˆ–é€£çµâ€¦">
      </div>
      <div class="right-actions">
        <button id="btnToggleGroup" class="btn small">åˆ†é¡æ¸…å–®</button>
        <button id="btnExpandAll" class="btn small">å…¨éƒ¨å±•é–‹</button>
        <button id="btnCollapseAll" class="btn small">å…¨éƒ¨æ”¶åˆ</button>
      </div>
    </div>
    <div id="catList"></div>
    <div class="grid" id="grid" style="display:none"></div>
  </section>

  <section id="contact">
    <div class="sec-head"><div class="sec-title"><span class="dot"></span><h2 style="font-size:22px">è¯çµ¡æˆ‘å€‘</h2></div></div>
    <div class="contact-cards">
      <div class="contact-card"><h3 style="margin:0 0 6px;font-size:16px">Instagram</h3><p id="igNote" class="meta" data-editable>è¿½è¹¤æ—¥å¸¸èˆ‡æœ€æ–°ä½œå“ï¼Œæ­¡è¿ç›´æ¥ç§è¨Šæ´½è«‡ã€‚</p><a id="igLink" class="btn" href="https://www.instagram.com/rqverycute" target="_blank" rel="noopener">å‰å¾€ IG</a></div>
      <div class="contact-card"><h3 style="margin:0 0 6px;font-size:16px">Facebook</h3><p id="fbNote" class="meta" data-editable>åŒæ­¥ç™¼å¸ƒå°ˆæ¡ˆèŠ±çµ®èˆ‡ä¸Šç·šè³‡è¨Šï¼Œæ­¡è¿ç•™è¨€ã€‚</p><a id="fbLink" class="btn" href="#" target="_blank" rel="noopener">å‰å¾€ FB</a></div>
    </div>
  </section>

  <footer>
    <div class="wrap" style="padding:0">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <small>Â© <span id="year"></span> <span id="footTitle">RQå¨›æ¨‚å½±åƒå·¥ä½œå®¤</span>. All rights reserved.</small>
        <small class="meta">Made with â˜•ï½œæ”¯æ´ç®¡ç†æ¨¡å¼ã€æœå°‹ã€åˆ†é¡å±•é–‹/æ”¶åˆã€æ‹–æ›³æ’åºã€åŒ¯å‡ºå–®æª”</small>
      </div>
    </div>
  </footer>
</main>

<!-- ç®¡ç†æµ®å‹•é¢æ¿ï¼ˆç™»å…¥å¾Œæ‰é¡¯ç¤ºï¼‰ -->
<div class="admin-fab">
  <div class="panel" id="panel">
    <button class="btn small" id="btnSettings">è¨­å®šï¼ˆç«™é»ï¼‰</button>
    <button class="btn small" id="btnAddCat">æ–°å¢åˆ†é¡</button>
    <button class="btn small" id="btnRenameCat">é‡æ–°å‘½ååˆ†é¡</button>
    <button class="btn small" id="btnDeleteCat">åˆªé™¤åˆ†é¡</button>
    <button class="btn small" id="btnAdd">æ–°å¢é€£çµ</button>
    <button class="btn small" id="btnSave">å„²å­˜è®Šæ›´</button>
    <button class="btn small" id="btnReset">æ¸…é™¤å„²å­˜</button>
    <button class="btn small" id="btnExport">åŒ¯å‡ºå–®æª”</button>
    <button class="btn small" id="btnLogout">ç™»å‡º</button>
    <button class="btn small" id="btnExit">é›¢é–‹ç®¡ç†</button>
  </div>
  <button class="fab" id="btnAdmin" style="display:none">ç®¡ç†</button>
</div>
<div class="admin-tip" id="tip"></div>

<!-- ç™»å…¥ï¼ˆå›ºå®šå¸³å¯†ï¼›ç„¡é‡è¨­ï¼‰ -->
<div class="login-mask" id="loginMask"><div class="login-card">
  <h3>ç™»å…¥ç®¡ç†å¾Œå°</h3>
  <div class="field"><label for="lgUser">å¸³è™Ÿ</label><input id="lgUser" type="text" placeholder="rqveryfilm"></div>
  <div class="field"><label for="lgPass">å¯†ç¢¼</label><input id="lgPass" type="password" placeholder="ä½ çš„å¯†ç¢¼"></div>
  <div class="row">
    <button class="btn primary small" id="btnDoLogin">ç™»å…¥</button>
    <button class="btn small" id="btnCancelLogin">å–æ¶ˆ</button>
  </div>
</div></div>

<!-- __STATE_INJECT__ -->

<script>
/* ===== é è¨­è³‡æ–™ï¼ˆå«æ‰€æœ‰åˆ†é¡èˆ‡é€£çµï¼‰ ===== */
const defaultData={site:{title:"RQå¨›æ¨‚å½±åƒå·¥ä½œå®¤",pageTitle:"RQå¨›æ¨‚å½±åƒå·¥ä½œå®¤ï½œä½œå“é›†",description:"RQå¨›æ¨‚å½±åƒå·¥ä½œå®¤ï½œæ—¥ç³»æ¸…çˆ½çš„å½±åƒæ•˜äº‹ï¼šPodcastã€çŸ­å½±ç‰‡å»£å‘Šã€å½¢è±¡å½±ç‰‡ã€è­‰è¨€å»£å‘Šã€ç¯€ç›®è£½ä½œã€‚",ogImage:"",heroTitle:"æŠŠç”Ÿæ´»æ‹æˆæ•…äº‹ï¼ŒæŠŠå“ç‰Œæ‹æˆè¨˜æ†¶ã€‚",heroLead:"æˆ‘å€‘å°ˆæ³¨æ–¼ Podcast ç¯€ç›®è£½ä½œã€çŸ­å½±ç‰‡å»£å‘Šã€å½¢è±¡å½±ç‰‡ã€è­‰è¨€å»£å‘Šã€ç¯€ç›®ä¼åŠƒèˆ‡åŸ·è¡Œã€‚æ¥µç°¡ç•«é¢è£¡ï¼Œç•™ä¸‹æœ€å‰›å¥½çš„æƒ…ç·’èˆ‡å…‰ã€‚",igUrl:"https://www.instagram.com/rqverycute",fbUrl:"#",notes:{quick:"ç§è¨Š IG æˆ– FBï¼Œæä¾›å¤§ç¶±ï¼é ç®—ï¼æ™‚ç¨‹ï¼Œæˆ‘å€‘ 24 å°æ™‚å…§å›è¦†ã€‚",ig:"è¿½è¹¤æ—¥å¸¸èˆ‡æœ€æ–°ä½œå“ï¼Œæ­¡è¿ç›´æ¥ç§è¨Šæ´½è«‡ã€‚",fb:"åŒæ­¥ç™¼å¸ƒå°ˆæ¡ˆèŠ±çµ®èˆ‡ä¸Šç·šè³‡è¨Šï¼Œæ­¡è¿ç•™è¨€ã€‚"}},embeds:{playlistId:"PLWPzSr-SQ2_oVby6sNPnVS7mzcG8Dv4Nz",featuredVideoId:"t0_lI52JDeI"},categories:[{name:"PODCAST ç¯€ç›®",key:"podcast",items:[{title:"ã€Šç™½ç›®æƒ…ä¾¶é€±è¨˜ã€‹æ’­æ”¾æ¸…å–®",url:"https://youtube.com/playlist?list=PLWPzSr-SQ2_oVby6sNPnVS7mzcG8Dv4Nz&si=IzthrcTC3XichKtF"}]},{name:"çŸ­å½±ç‰‡å»£å‘Š",key:"shortads",items:[{title:"çŸ­å½±ç‰‡å»£å‘Š 1",url:"https://www.instagram.com/p/DK3to-PhV25/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 2",url:"https://www.instagram.com/p/DK4TC7Uytk8/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 3",url:"https://www.instagram.com/reel/DGKd2p7toNV/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 4",url:"https://www.instagram.com/p/DKGdXN7BSyf/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 5",url:"https://www.instagram.com/p/DEjHmrfBR21/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 6",url:"https://www.instagram.com/p/DDJKTiwh6vn/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 7",url:"https://www.instagram.com/p/DKdr-XQTdXo/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 8",url:"https://www.instagram.com/reel/DGKd2p7toNV/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 9",url:"https://www.instagram.com/rqverycute/reel/DCTrqu1hP7B/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 10",url:"https://www.instagram.com/p/DJRNuFRyMdy/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 11",url:"https://www.instagram.com/p/DGzXkTLhyjJ/"},{title:"çŸ­å½±ç‰‡å»£å‘Š 12",url:"https://www.instagram.com/reel/DL7qshjSXMK/"}]},{name:"è—é¡äººç³»åˆ—",key:"behind",items:[{title:"è—é¡äºº 1",url:"https://www.instagram.com/p/DInYfEKyuK3/"},{title:"è—é¡äºº 2",url:"https://www.instagram.com/p/DH370JFzFka/"},{title:"è—é¡äºº 3",url:"https://www.instagram.com/p/DJlCFbgBvbs/"},{title:"è—é¡äºº 4",url:"https://www.instagram.com/p/DJLMJ8cBrQh/"},{title:"è—é¡äºº 5",url:"https://www.instagram.com/p/DJGBI0VBDRz/"}]},{name:"å½¢è±¡å½±ç‰‡",key:"brand",items:[{title:"å½¢è±¡å½±ç‰‡ 1",url:"https://www.instagram.com/p/DLj-XoiTlyI/"},{title:"å½¢è±¡å½±ç‰‡ 2",url:"https://www.instagram.com/p/DJl1UNnz3F6/"},{title:"å½¢è±¡å½±ç‰‡ 3",url:"https://www.instagram.com/p/DH3pfAUzqq3/"},{title:"å½¢è±¡å½±ç‰‡ 4",url:"https://www.instagram.com/p/DMpj7CXTFR7/"},{title:"å½¢è±¡å½±ç‰‡ 5",url:"https://www.instagram.com/p/DMaqy4pz8qA/"},{title:"å½¢è±¡å½±ç‰‡ 6",url:"https://www.instagram.com/p/DMcnM5sT-QY/"}]},{name:"è­‰è¨€å»£å‘Š",key:"testimony",items:[{title:"è­‰è¨€å»£å‘Š 1",url:"https://youtu.be/3Wa_3spT3aY"},{title:"è­‰è¨€å»£å‘Š 2",url:"https://youtu.be/Tj7lKWKZj8U"},{title:"è­‰è¨€å»£å‘Š 3",url:"https://youtu.be/fQcpSTPE4fM"},{title:"è­‰è¨€å»£å‘Š 4",url:"https://youtu.be/vhtDZfVhafM"},{title:"è­‰è¨€å»£å‘Š 5",url:"https://youtu.be/t9nsWWcfKWI"},{title:"è­‰è¨€å»£å‘Š 6",url:"https://youtu.be/-VRPXP1yW7U"},{title:"è­‰è¨€å»£å‘Š 7",url:"https://youtu.be/kp4x2ClTR90"},{title:"è­‰è¨€å»£å‘Š 8",url:"https://youtu.be/zOPASyqrOqc"}]},{name:"ç¯€ç›®è£½ä½œ",key:"shows",items:[{title:"ç¯€ç›®è£½ä½œ 1",url:"https://www.youtube.com/watch?v=t0_lI52JDeI"},{title:"ç¯€ç›®è£½ä½œ 2",url:"https://www.youtube.com/watch?v=jO_J0opLGcE&t=76s"},{title:"ç¯€ç›®è£½ä½œ 3",url:"https://www.youtube.com/watch?v=xQEgmB6asXA&t=70s"},{title:"ç¯€ç›®è£½ä½œ 4",url:"https://youtu.be/tuqjc_3dMdg"},{title:"ç¯€ç›®è£½ä½œ 5",url:"https://youtu.be/7cLpRdSYzfc"},{title:"ç¯€ç›®è£½ä½œ 6",url:"https://youtu.be/h1R7CxRCJRc"},{title:"ç¯€ç›®è£½ä½œ 7",url:"https://youtu.be/JtdX1qPKWcA"},{title:"ç¯€ç›®è£½ä½œ 8",url:"https://youtu.be/eWtQGFsnxJI"},{title:"ç¯€ç›®è£½ä½œ 9",url:"https://youtu.be/JAeJV8I-fP0"},{title:"ç¯€ç›®è£½ä½œ 10",url:"https://youtu.be/jUovV89BiiA"},{title:"ç¯€ç›®è£½ä½œ 11",url:"https://youtu.be/wx8Y7VIKfgQ"},{title:"ç¯€ç›®è£½ä½œ 12",url:"https://www.youtube.com/watch?v=GC6jZYH3njs"},{title:"ç¯€ç›®è£½ä½œ 13",url:"https://www.youtube.com/watch?v=VZRkXoK_9Dc"},{title:"ç¯€ç›®è£½ä½œ 14",url:"https://www.youtube.com/watch?v=1itzE92qo9I"},{title:"ç¯€ç›®è£½ä½œ 15",url:"https://www.youtube.com/watch?v=nSFi6or-uQs"},{title:"ç¯€ç›®è£½ä½œ 16",url:"https://www.youtube.com/watch?v=efSXeNzd7-U"}]}]};

/* ===== ç‹€æ…‹è¼‰å…¥ ===== */
const injectedData=(typeof EXPORTED_SITE_DATA!=="undefined")?EXPORTED_SITE_DATA:null;
const saved=localStorage.getItem("rq_site_data");
let siteData=injectedData||(saved?JSON.parse(saved):defaultData);

/* ===== DOM ===== */
const grid=document.getElementById('grid'),catList=document.getElementById('catList');
const search=document.getElementById('search'),panel=document.getElementById('panel'),btnAdmin=document.getElementById('btnAdmin'),tip=document.getElementById('tip');
const btnToggleGroup=document.getElementById('btnToggleGroup'),btnExpandAll=document.getElementById('btnExpandAll'),btnCollapseAll=document.getElementById('btnCollapseAll');
const podcastEmbed=document.getElementById('podcastEmbed'),videoEmbed=document.getElementById('videoEmbed');
const btnEditPlaylist=document.getElementById('btnEditPlaylist'),btnEditVideo=document.getElementById('btnEditVideo');

/* ===== ç‹€æ…‹ ===== */
let isEditing=false,grouped=true; let dragCtx=null;

/* ===== æ¸²æŸ“ï¼šåˆ†é¡ + å°é¢ ===== */
function renderGrid(){
  const q=search.value.trim().toLowerCase();
  if(grouped){
    grid.style.display='none'; catList.style.display='block'; catList.innerHTML='';
    siteData.categories.forEach(cat=>{
      const items=cat.items.filter(it=>(it.title+" "+it.url).toLowerCase().includes(q));
      if(items.length===0) return;
      const catEl=document.createElement('div'); catEl.className='cat';
      const cover=document.createElement('div'); cover.className='cover';
      cover.innerHTML=`<div class="cover-inner"><div class="cover-info"><h3>${cat.name}</h3><p>${coverSubtitle(cat.key)}ã€€<span class="cat-count">å…± ${items.length} é …</span></p></div><div class="cover-illu">${coverSVG(cat.key)}</div></div>`;
      cover.onclick=()=>{ catEl.classList.toggle('open'); };
      const head=document.createElement('div'); head.className='cat-head';
      const title=document.createElement('div'); title.className='cat-title'; title.innerHTML=`<span class="dot"></span><span>${cat.name}</span>`;
      const actions=document.createElement('div'); actions.className='cat-actions';
      const tgl=document.createElement('button'); tgl.className='btn small'; tgl.textContent='å±•é–‹';
      tgl.onclick=()=>{ catEl.classList.toggle('open'); tgl.textContent=catEl.classList.contains('open')?'æ”¶åˆ':'å±•é–‹'; };
      actions.appendChild(tgl); head.append(title,actions);
      const body=document.createElement('div'); body.className='cat-body';
      const inner=document.createElement('div'); inner.className='grid'; inner.dataset.cat=cat.key;

      items.forEach(it=>{ const idx=cat.items.indexOf(it); inner.appendChild(buildCard(cat,idx)); });

      inner.addEventListener('dragover',e=>{
        if(!isEditing||!dragCtx) return; if(dragCtx.catKey!==cat.key) return;
        e.preventDefault(); const targetCard=e.target.closest('.card');
        document.querySelectorAll('.drop-target').forEach(n=>n.classList.remove('drop-target'));
        if(targetCard) targetCard.classList.add('drop-target');
      });
      inner.addEventListener('dragleave',()=>{ document.querySelectorAll('.drop-target').forEach(n=>n.classList.remove('drop-target')); });
      inner.addEventListener('drop',e=>{
        if(!isEditing||!dragCtx) return; if(dragCtx.catKey!==cat.key) return;
        e.preventDefault(); const targetCard=e.target.closest('.card');
        const toIdx= targetCard ? parseInt(targetCard.dataset.idx,10) : cat.items.length-1;
        reorderWithin(cat.key, dragCtx.fromIdx, toIdx); dragCtx=null;
      });

      body.appendChild(inner);
      catEl.append(cover,head,body);
      catList.appendChild(catEl);
    });
  }else{
    catList.style.display='none'; grid.style.display='grid'; grid.innerHTML='';
    siteData.categories.forEach(cat=>{
      cat.items.forEach((it,idx)=>{
        const text=(it.title+" "+it.url).toLowerCase();
        if(q && !text.includes(q)) return;
        grid.appendChild(buildCard(cat,idx,false));
      });
    });
  }
  document.body.classList.toggle('editing',isEditing);
  btnEditPlaylist.style.display=isEditing?'inline-flex':'none';
  btnEditVideo.style.display=isEditing?'inline-flex':'none';
}

/* ===== å¡ç‰‡ ===== */
function buildCard(cat,idx,draggable=true){
  const it=cat.items[idx];
  const card=document.createElement('div'); card.className='card'; card.dataset.cat=cat.key; card.dataset.idx=idx;
  if(draggable && isEditing && grouped){
    card.setAttribute('draggable','true');
    card.addEventListener('dragstart',e=>{ dragCtx={catKey:cat.key,fromIdx:idx}; card.classList.add('dragging'); e.dataTransfer.setData('text/plain',JSON.stringify(dragCtx));});
    card.addEventListener('dragend',()=>{ card.classList.remove('dragging'); document.querySelectorAll('.drop-target').forEach(n=>n.classList.remove('drop-target')); });
  }else{ card.removeAttribute('draggable'); }
  const btnX=document.createElement('button'); btnX.className='x'; btnX.title='åˆªé™¤'; btnX.textContent='Ã—';
  btnX.onclick=()=>{ if(confirm('ç¢ºå®šåˆªé™¤æ­¤é€£çµï¼Ÿ')){ cat.items.splice(idx,1); renderGrid(); saveToLocal('å·²åˆªé™¤'); } };
  const btnEdit=document.createElement('button'); btnEdit.className='edit'; btnEdit.title='ç·¨è¼¯'; btnEdit.textContent='âœ';
  btnEdit.onclick=()=> editItem(cat,idx);
  const dragIcon=document.createElement('div'); dragIcon.className='drag-hint'; dragIcon.title='æ‹–æ›³æ’åº'; dragIcon.innerHTML='â‹®â‹®';
  card.append(btnX,btnEdit,dragIcon);
  const t=document.createElement('div'); t.className='title'; t.textContent=it.title; t.contentEditable=isEditing; t.oninput=()=>{ it.title=t.textContent; };
  const m=document.createElement('div'); m.className='meta'; try{ m.textContent=new URL(it.url).hostname.replace('www.',''); }catch(e){ m.textContent='é€£çµ'; }
  const row=document.createElement('div'); row.className='actions';
  const open=document.createElement('a'); open.className='btn small open'; open.textContent='é–‹å•Ÿé€£çµ'; open.href=it.url; open.target='_blank'; open.rel='noopener';
  row.append(open); card.append(t,m,row); return card;
}

/* ===== æ‹–æ›³æ’åºï¼šåŒåˆ†é¡å…§é‡æ’ ===== */
function reorderWithin(catKey,from,to){
  if(from===to) return; const cat=siteData.categories.find(c=>c.key===catKey); if(!cat) return;
  const list=cat.items; const item=list.splice(from,1)[0]; let toIdx=to; if(toIdx<0) toIdx=0; if(toIdx>list.length) toIdx=list.length; list.splice(toIdx,0,item);
  saveToLocal('å·²é‡æ–°æ’åº'); renderGrid();
}

/* ===== å°é¢æ’åœ– ===== */
function coverSubtitle(key){switch(key){case 'podcast': return 'å…©äººä¸€éº¥ãƒ»å¥½å¥½èªªè©±';case 'shortads': return 'çŸ­å½±å³æ“Šä¸­ãƒ»ä¸€é¡å…¥é­‚';case 'behind': return 'è—é¡äººãƒ»å¹•å¾Œç´€éŒ„';case 'brand': return 'å½¢è±¡æ§‹ç¯‰ãƒ»å…‰èˆ‡å½±çš„åç‰‡';case 'testimony': return 'çœŸå¯¦å£ç¢‘ãƒ»èªªæœåŠ›ä¸Šç·š';case 'shows': return 'ç¯€ç›®ä¼åŠƒãƒ»å…§å®¹è£½ä½œ';default: return 'ç²¾é¸ä½œå“';}}
function coverSVG(key){const stroke='#9C6B3D', orange='var(--orange)'; if(key==='podcast'){return `<svg viewBox="0 0 600 338" xmlns="http://www.w3.org/2000/svg"><rect width="600" height="338" fill="none"/><circle cx="180" cy="170" r="60" fill="#FFEFD9" stroke="${stroke}" stroke-width="3"/><circle cx="420" cy="170" r="60" fill="#FFEFD9" stroke="${stroke}" stroke-width="3"/><rect x="278" y="130" width="44" height="120" rx="10" fill="${orange}"/><rect x="270" y="248" width="60" height="12" rx="6" fill="#E3C7A2"/><line x1="260" y1="130" x2="340" y2="130" stroke="${stroke}" stroke-width="3"/><line x1="260" y1="250" x2="340" y2="250" stroke="${stroke}" stroke-width="3"/><circle cx="180" cy="170" r="6" fill="${stroke}"/><circle cx="420" cy="170" r="6" fill="${stroke}"/></svg>`} if(key==='shortads'){return `<svg viewBox="0 0 600 338" xmlns="http://www.w3.org/2000/svg"><rect x="70" y="70" width="220" height="140" rx="14" fill="#FFF" stroke="${stroke}" stroke-width="3"/><polygon points="125,125 205,170 125,215" fill="${orange}"/><rect x="360" y="90" width="150" height="190" rx="16" fill="#FFF" stroke="${stroke}" stroke-width="3"/><circle cx="435" cy="150" r="34" fill="#FFE5C2" stroke="${stroke}" stroke-width="3"/><rect x="415" y="205" width="40" height="40" rx="8" fill="${orange}"/></svg>`} if(key==='behind'){return `<svg viewBox="0 0 600 338" xmlns="http://www.w3.org/2000/svg"><path d="M60 170 Q300 70 540 170 Q300 270 60 170Z" fill="#FFEFD9" stroke="${stroke}" stroke-width="3"/><circle cx="300" cy="170" r="46" fill="${orange}"/><rect x="230" y="60" width="140" height="28" rx="6" fill="#FFF" stroke="${stroke}" stroke-width="3"/><rect x="230" y="92" width="140" height="18" rx="4" fill="#FFF" stroke="${stroke}" stroke-width="3"/></svg>`} if(key==='brand'){return `<svg viewBox="0 0 600 338" xmlns="http://www.w3.org/2000/svg"><circle cx="170" cy="170" r="70" fill="#FFF" stroke="${stroke}" stroke-width="3"/><circle cx="170" cy="170" r="30" fill="${orange}"/><circle cx="420" cy="170" r="90" fill="none" stroke="${stroke}" stroke-width="3" stroke-dasharray="6 10"/><circle cx="420" cy="170" r="30" fill="${orange}"/></svg>`} if(key==='testimony'){return `<svg viewBox="0 0 600 338" xmlns="http://www.w3.org/2000/svg"><rect x="120" y="90" width="360" height="140" rx="16" fill="#FFF" stroke="${stroke}" stroke-width="3"/><text x="150" y="160" font-size="64" fill="${orange}" font-family="serif">â€œ â€</text><rect x="220" y="240" width="160" height="12" rx="6" fill="#E3C7A2"/></svg>`} if(key==='shows'){return `<svg viewBox="0 0 600 338" xmlns="http://www.w3.org/2000/svg"><rect x="120" y="70" width="360" height="200" rx="14" fill="#FFF" stroke="${stroke}" stroke-width="3"/><polygon points="300,130 360,170 300,210" fill="${orange}"/><rect x="240" y="280" width="120" height="10" rx="5" fill="#E3C7A2"/></svg>`} return `<svg viewBox="0 0 600 338"></svg>`;}

/* ===== æ–‡æ¡ˆ/é€£çµæ³¨å…¥ã€å„²å­˜ã€åŒ¯å‡º ===== */
const editableIds=["siteTitle","heroTitle","heroLead","quickNote","igNote","fbNote"];
const linkIds=[{id:"ctaIG",key:"igUrl"},{id:"ctaFB",key:"fbUrl"},{id:"igLink",key:"igUrl"},{id:"fbLink",key:"fbUrl"}];
function hydrateText(){document.getElementById('siteTitle').textContent=siteData.site.title;document.getElementById('heroTitle').textContent=siteData.site.heroTitle;document.getElementById('heroLead').textContent=siteData.site.heroLead;document.getElementById('quickNote').textContent=siteData.site.notes.quick;document.getElementById('igNote').textContent=siteData.site.notes.ig;document.getElementById('fbNote').textContent=siteData.site.notes.fb;document.getElementById('footTitle').textContent=siteData.site.title;document.title=siteData.site.pageTitle||siteData.site.title;linkIds.forEach(({id,key})=>{const a=document.getElementById(id); if(a) a.href=siteData.site[key]||"#";});updateEmbeds();}
function toast(t){tip.textContent=t;tip.style.display='block';setTimeout(()=>{tip.style.display='none'},2000);}
function addLink(){const cats=siteData.categories.map(c=>c.name).join(" / ");const cName=prompt("æ–°å¢åˆ°å“ªå€‹åˆ†é¡ï¼Ÿï¼ˆè¼¸å…¥åˆ†é¡å…¨åï¼‰\n"+cats); if(!cName) return; const cat=siteData.categories.find(c=>c.name===cName.trim()); if(!cat){alert("æ‰¾ä¸åˆ°æ­¤åˆ†é¡");return;} const url=prompt("è²¼ä¸Šé€£çµ URLï¼š"); if(!url) return; const title=prompt("é¡¯ç¤ºæ¨™é¡Œï¼š","æ–°é€£çµ"); cat.items.push({title:title||"æœªå‘½åé€£çµ",url}); saveToLocal("å·²æ–°å¢é€£çµ");}
function exportFile(){saveToLocal("æº–å‚™åŒ¯å‡ºâ€¦"); let html=document.documentElement.outerHTML; const stateScript=`<script>var EXPORTED_SITE_DATA=${JSON.stringify(siteData)};<\/script>`; html=html.replace("<!-- __STATE_INJECT__ -->",stateScript); const blob=new Blob([html],{type:"text/html;charset=utf-8"}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=(siteData.site.title||'RQ-portfolio')+".html"; a.click(); URL.revokeObjectURL(a.href); toast("å·²ä¸‹è¼‰å–®æª” HTML");}
function slugify(s){return s.trim().toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,'');}
function addCategory(){const name=prompt("æ–°åˆ†é¡åç¨±ï¼š"); if(!name) return; let key=slugify(name); if(siteData.categories.some(c=>c.key===key)) key=key+(Date.now()%1000); siteData.categories.push({name,key,items:[]}); saveToLocal("å·²æ–°å¢åˆ†é¡");}
function renameCategory(){const list=siteData.categories.map(c=>c.name).join(' / '); const oldName=prompt("æ¬²é‡æ–°å‘½åçš„åˆ†é¡ï¼ˆè¼¸å…¥å…¨åï¼‰ï¼š\n"+list); if(!oldName) return; const cat=siteData.categories.find(c=>c.name===oldName.trim()); if(!cat){alert('æ‰¾ä¸åˆ°åˆ†é¡');return;} const nn=prompt("æ–°åˆ†é¡åç¨±ï¼š",cat.name); if(!nn) return; cat.name=nn.trim(); saveToLocal("å·²æ›´å");}
function deleteCategory(){const list=siteData.categories.map(c=>c.name).join(' / '); const name=prompt("è¦åˆªé™¤å“ªå€‹åˆ†é¡ï¼Ÿï¼ˆè¼¸å…¥å…¨åï¼‰ï¼š\n"+list); if(!name) return; const idx=siteData.categories.findIndex(c=>c.name===name.trim()); if(idx===-1){alert('æ‰¾ä¸åˆ°åˆ†é¡');return;} if(!confirm(`åˆªé™¤åˆ†é¡ã€Œ${name}ã€åŠå…¶æ‰€æœ‰é€£çµï¼Ÿ`))return; siteData.categories.splice(idx,1); saveToLocal("å·²åˆªé™¤åˆ†é¡");}
function editItem(cat,idx){const it=cat.items[idx]; const t=prompt('ä¿®æ”¹æ¨™é¡Œï¼š',it.title); if(t!==null) it.title=t.trim()||it.title; const u=prompt('ä¿®æ”¹ URLï¼š',it.url); if(u!==null) it.url=u.trim()||it.url; saveToLocal('å·²æ›´æ–°å¡ç‰‡');}

/* æ’­æ”¾å™¨ */
function ytPlaylistUrl(id){return `https://www.youtube.com/embed/videoseries?list=${encodeURIComponent(id)}&rel=0&modestbranding=1`;}
function ytVideoUrl(id){return `https://www.youtube.com/embed/${encodeURIComponent(id)}?rel=0&modestbranding=1`;}
function updateEmbeds(){const listId=siteData.embeds?.playlistId||defaultData.embeds.playlistId; const vidId=siteData.embeds?.featuredVideoId||defaultData.embeds.featuredVideoId; podcastEmbed.src=ytPlaylistUrl(listId); videoEmbed.src=ytVideoUrl(vidId);}

/* ====== å›ºå®šå¸³å¯†ç™»å…¥ï¼ˆç„¡é‡è¨­ï¼‰ ====== */
const FIXED_USER="rqveryfilm";
const FIXED_PASS_HASH="ce8c9b642485c653cc0f250141b01758c6b333ed2d1abc7230c88b458617a7db"; // cj86u4QQ
const loginMask=document.getElementById('loginMask');
async function sha256(t){const enc=new TextEncoder().encode(t);const buf=await crypto.subtle.digest('SHA-256',enc);return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');}
function showLogin(){loginMask.style.display='flex';} function hideLogin(){loginMask.style.display='none';}
document.getElementById('btnDoLogin').onclick=async()=>{const u=document.getElementById('lgUser').value.trim(); const p=document.getElementById('lgPass').value.trim(); if(u!==FIXED_USER){alert("å¸³è™ŸéŒ¯èª¤");return;} const ok=(await sha256(p))===FIXED_PASS_HASH; if(!ok){alert("å¯†ç¢¼éŒ¯èª¤");return;} hideLogin(); enterEdit();};
document.getElementById('btnCancelLogin').onclick=()=> hideLogin();

/* ====== ç·¨è¼¯æ¨¡å¼ ====== */
function enterEdit(){isEditing=true; document.querySelector('.admin-fab').style.display='block'; document.getElementById('btnAdmin').style.display='inline-flex'; panel.classList.add('show'); btnAdmin.textContent="ç®¡ç†ä¸­"; editableIds.forEach(id=>{const el=document.getElementById(id); el.setAttribute('contenteditable','true'); el.classList.add('admin');}); renderGrid(); toast("å·²é€²å…¥ç®¡ç†æ¨¡å¼ï¼ˆShift+M / é•·æŒ‰æˆ–é€£é» LOGOï¼‰");}
function exitEdit(){isEditing=false; panel.classList.remove('show'); btnAdmin.textContent="ç®¡ç†"; editableIds.forEach(id=>{const el=document.getElementById(id); el.removeAttribute('contenteditable'); el.classList.remove('admin');}); renderGrid();}
document.getElementById('btnExit').onclick=()=> exitEdit();
document.getElementById('btnLogout').onclick=()=>{ exitEdit(); document.querySelector('.admin-fab').style.display='none'; document.getElementById('btnAdmin').style.display='none'; toast("å·²ç™»å‡º");};

/* ç®¡ç†éˆ•ï¼ˆç™»å…¥å¾Œå¯ç”¨ä¾†åˆ‡æ›é¢æ¿ï¼‰ */
document.getElementById('btnAdmin').onclick=()=>{ if(isEditing){ panel.classList.toggle('show'); } else { showLogin(); } };

/* ====== ç†±éµï¼šShift + M ====== */
document.addEventListener('keydown',(e)=>{ if(e.shiftKey && (e.key==='M' || e.key==='m')){ if(isEditing){ panel.classList.toggle('show'); } else { showLogin(); } }});

/* ====== æ‰‹æ©Ÿ & éš±è—å…¥å£ï¼šé•·æŒ‰ / ä¸‰é€£é» Logo + ?admin=rq ====== */
(function setupHiddenAdminEntrances(){ const logo = document.querySelector('.logo'); const qs = new URLSearchParams(location.search); const ADMIN_KEY = "rq"; if (qs.get('admin') === ADMIN_KEY) showLogin(); let lpTimer=null,touching=false; const startLP=()=>{touching=true;lpTimer=setTimeout(()=>{if(touching) showLogin();},1200);}; const cancelLP=()=>{touching=false;clearTimeout(lpTimer);}; logo.addEventListener('touchstart',startLP,{passive:true}); logo.addEventListener('touchend',cancelLP,{passive:true}); logo.addEventListener('touchmove',cancelLP,{passive:true}); logo.addEventListener('mousedown',startLP); logo.addEventListener('mouseup',cancelLP); logo.addEventListener('mouseleave',cancelLP); let taps=0,firstTapAt=0; logo.addEventListener('click',()=>{ const now=Date.now(); if(now-firstTapAt>1500){taps=0;firstTapAt=now;} taps++; if(taps===1) firstTapAt=now; if(taps>=3){taps=0;showLogin();} });})();

/* äº‹ä»¶ï¼šä¸€èˆ¬æ“ä½œ */
document.getElementById('btnSave').onclick=()=> saveToLocal();
document.getElementById('btnReset').onclick=()=>{ if(confirm("ç¢ºå®šæ¸…é™¤ç€è¦½å™¨ä¸­çš„æš«å­˜ï¼Ÿï¼ˆä¸å½±éŸ¿åŸæª”ï¼‰")){localStorage.removeItem("rq_site_data"); siteData=injectedData||defaultData; hydrateText(); renderGrid(); toast("å·²æ¸…é™¤å„²å­˜");}};
document.getElementById('btnExport').onclick=()=> exportFile();
document.getElementById('btnAdd').onclick=()=> addLink();
document.getElementById('btnSettings').onclick=()=> openSettings();
document.getElementById('btnAddCat').onclick=()=> addCategory();
document.getElementById('btnRenameCat').onclick=()=> renameCategory();
document.getElementById('btnDeleteCat').onclick=()=> deleteCategory();
search.addEventListener('input',()=> renderGrid());
btnToggleGroup.addEventListener('click',()=>{grouped=!grouped;btnToggleGroup.textContent=grouped?'åˆ†é¡æ¸…å–®':'å¡ç‰‡ç¸½è¦½';renderGrid();});
btnExpandAll.addEventListener('click',()=>{document.querySelectorAll('.cat').forEach(c=>c.classList.add('open'));});
btnCollapseAll.addEventListener('click',()=>{document.querySelectorAll('.cat').forEach(c=>c.classList.remove('open'));});

/* è¨­å®š */
function openSettings(){const s=siteData.site; const t=prompt("ç¶²ç«™é¡¯ç¤ºåç¨±ï¼ˆé é¢ H1ï¼‰ï¼š",s.title||''); if(t!==null) s.title=t.trim()||s.title; const pt=prompt("ç€è¦½å™¨åˆ†é æ¨™é¡Œï¼ˆ<title>ï¼‰ï¼š",s.pageTitle||document.title); if(pt!==null) s.pageTitle=pt.trim()||s.pageTitle; const d=prompt("SEO æè¿°ï¼ˆmeta descriptionï¼‰ï¼š",s.description||''); if(d!==null) s.description=d.trim(); const og=prompt("OG åœ–ç‰‡ç¶²å€ï¼ˆåˆ†äº«ç¸®åœ–ï¼‰ï¼š",s.ogImage||''); if(og!==null) s.ogImage=og.trim(); const ig=prompt("Instagram é€£çµï¼š",s.igUrl||''); if(ig!==null) s.igUrl=ig.trim(); const fb=prompt("Facebook é€£çµï¼š",s.fbUrl||''); if(fb!==null) s.fbUrl=fb.trim(); saveToLocal("å·²æ›´æ–°ç«™é»è¨­å®š");}

/* Init */
function init(){const y=document.getElementById('year'); if(y) y.textContent=new Date().getFullYear(); hydrateText(); renderGrid(); updateEmbeds();}
init();
/* ========== ğŸ”¥ Firebase å³æ™‚åŒæ­¥æ•´åˆ ğŸ”¥ ========== */
</script>

<script type="module">
  // å¼•å…¥ Firebase
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
  import { getFirestore, doc, getDoc, setDoc, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

  // ä½ çš„ Firebase è¨­å®š
  const firebaseConfig = {
    apiKey: "AIzaSyAXy9M_I_RdbjoDsjPleRFzamjPanBLKCA",
    authDomain: "rqveryfilm.firebaseapp.com",
    projectId: "rqveryfilm",
    storageBucket: "rqveryfilm.appspot.com",
    messagingSenderId: "778310367808",
    appId: "1:778310367808:web:bb0ed0b7bb50b2d0874f"
  };

  // åˆå§‹åŒ– Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const SITE_DOC = doc(db, "siteData", "main");

  // å¾ Firebase è¼‰å…¥è³‡æ–™
  async function loadFromFirebase() {
    try {
      const snap = await getDoc(SITE_DOC);
      if (snap.exists()) {
        window.siteData = snap.data();
        window.hydrateText();
        window.renderGrid();
        console.log('âœ… å·²å¾ Firebase è¼‰å…¥è³‡æ–™');
      } else {
        // ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼ŒæŠŠé è¨­è³‡æ–™å­˜åˆ° Firebase
        await setDoc(SITE_DOC, window.siteData);
        console.log('âœ… å·²åˆå§‹åŒ– Firebase è³‡æ–™');
      }
    } catch (error) {
      console.error('âŒ Firebase è¼‰å…¥å¤±æ•—:', error);
      alert('é€£ç·š Firebase å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯');
    }
  }

  // å³æ™‚ç›£è½ï¼šä»»ä½•è£ç½®ä¿®æ”¹ï¼Œå…¶ä»–è£ç½®ç«‹åˆ»æ›´æ–°
  onSnapshot(SITE_DOC, (snap) => {
    if (snap.exists()) {
      window.siteData = snap.data();
      window.hydrateText();
      window.renderGrid();
      console.log('ğŸ”„ è³‡æ–™å·²åŒæ­¥æ›´æ–°');
    }
  }, (error) => {
    console.error('âŒ Firebase ç›£è½å¤±æ•—:', error);
  });

  // ä¿®æ”¹åŸæœ¬çš„ saveToLocal å‡½å¼ï¼Œæ”¹ç‚ºå­˜åˆ° Firebase
  const originalSaveToLocal = window.saveToLocal;
  window.saveToLocal = async function(msg = "å·²å„²å­˜") {
    // æ”¶é›†é é¢å…§å®¹ï¼ˆä½¿ç”¨åŸæœ¬çš„é‚è¼¯ï¼‰
    window.siteData.site.title = document.getElementById('siteTitle').textContent.trim();
    window.siteData.site.heroTitle = document.getElementById('heroTitle').textContent.trim();
    window.siteData.site.heroLead = document.getElementById('heroLead').textContent.trim();
    window.siteData.site.notes.quick = document.getElementById('quickNote').textContent.trim();
    window.siteData.site.notes.ig = document.getElementById('igNote').textContent.trim();
    window.siteData.site.notes.fb = document.getElementById('fbNote').textContent.trim();

    try {
      // å­˜åˆ° Firebaseï¼ˆæœƒè‡ªå‹•è§¸ç™¼å…¶ä»–è£ç½®æ›´æ–°ï¼‰
      await setDoc(SITE_DOC, window.siteData);
      window.toast(msg + ' ğŸ”„ å·²åŒæ­¥åˆ°é›²ç«¯');
      console.log('âœ… å·²å„²å­˜åˆ° Firebase');
    } catch (error) {
      console.error('âŒ Firebase å„²å­˜å¤±æ•—:', error);
      window.toast('âŒ å„²å­˜å¤±æ•—ï¼š' + error.message);
    }
  };

  // ç­‰å¾… DOM è¼‰å…¥å®Œæˆå¾Œå†åˆå§‹åŒ–
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadFromFirebase);
  } else {
    loadFromFirebase();
  }
</script>

</script>
</body>
</html>
